"inc" = milk$I,
"type" = "lfc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_ww <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"type" = "ww",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_lfw <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"type" = "lfw",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_wc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"type" = "wc",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
new_milk$type_dum <- factor(new_milk$type)
lm.object <- lm(bid ~ inc + type_dum*inc + logfmo*inc + logqstop*inc + back*inc + esc*inc + num*inc
+ type_dum*(1-inc) + logfmo*(1-inc) + logqstop*(1-inc) + back*(1-inc) + esc*(1-inc) + num*(1-inc), data=new_milk, na.action=na.exclude)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum.f <- factor(new_milk$year)
new_milk$sys_dum.f <- factor(new_milk$system)
new_milk$type_dum.f <- factor(new_milk$type)
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"type" = "lfc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_ww <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"type" = "ww",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_lfw <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"type" = "lfw",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_wc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"type" = "wc",
"logfmo" = log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
new_milk$type_dum <- factor(new_milk$type)
lm.object <- lm(bid ~ inc  + logfmo*inc + logqstop*inc + back*inc + esc*inc + num*inc
+ logfmo*(1-inc) + logqstop*(1-inc) + back*(1-inc) + esc*(1-inc) + num*(1-inc), data=new_milk, na.action=na.exclude)
lm.object <- lm(bid ~ inc  + logfmo*inc + logqstop*inc + back*inc + esc*inc + num*inc, data=new_milk, na.action=na.exclude)
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"type" = "lfc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_ww <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"type" = "ww",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_lfw <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"type" = "lfw",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_wc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"type" = "wc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
new_milk$type_dum <- factor(new_milk$type)
library(dummies)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
new_milk$type_dum <- factor(new_milk$type)
install.packages("dummies")
install.packages("dummies")
library(dummies)
new_milk$year_dum <- cbind(new_milk, dummy(new_milk$year,sep = "_"))
new_milk$sys_dum <- cbind(new_milk, dummy(new_milk$sys,sep = "_"))
new_milk$type_dum <- cbind(new_milk, dummy(new_milk$type,sep = "_"))
lm.object <- lm(bid ~ type_dum, new_milk, na.action=na.exclude)
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"lfci" =   milk$I* rep(1,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(1,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_ww <-data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_lfw <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(1,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(1,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_wc <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(1,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(1,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
new_milk$type_dum <- factor(new_milk$type)
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"lfci" =   milk$I* rep(1,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(1,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_ww <-data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_lfw <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(1,nrow(milk)),
"wci" =  milk$I * rep(0,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(1,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(0,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_wc <- data.frame("vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"lfci" =   milk$I* rep(0,nrow(milk)),
"lfwi" =   milk$I* rep(0,nrow(milk)),
"wci" =  milk$I * rep(1,nrow(milk)),
"logfmoi" = milk$I * log(milk$FMO),
"logqstopi" = milk$I * log(milk$QSTOP),
"backi" = milk$I * log(1+milk$BACKLOG),
"esci" = milk$I * milk$ESC,
"numi" = milk$I * milk$N,
"lfcni" =   (1-milk$I) * rep(0,nrow(milk)),
"lfwni" =   (1-milk$I) * rep(0,nrow(milk)),
"wcni" =  (1-milk$I)  * rep(1,nrow(milk)),
"logfmoni" = (1-milk$I) * log(milk$FMO),
"logqstopni" = (1-milk$I) * log(milk$QSTOP),
"backni" = (1-milk$I)  *log(1+milk$BACKLOG),
"numni" = (1-milk$I) * milk$N,
"escni" = (1-milk$I) * milk$ESC)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
lm.object <- lm(bid ~ inc + lfci + lfwi + wci + logfmoi + logqstopi + backi + esci + numi
+ lfcni + lfwni + wcni + logfmoni + logqstopni + backni + escni + numni +, new_milk)
lm.object <- lm(bid ~ inc + lfci + lfwi + wci + logfmoi + logqstopi + backi + esci + numi
+ lfcni + lfwni + wcni + logfmoni + logqstopni + backni + escni + numni + year_dum + sys_dum, new_milk)
summary(lm.object )
lm.object <- lm(bid ~ inc + lfci + lfwi + wci + logfmoi + logqstopi + backi + esci + numi
+ lfcni + lfwni + wcni + logfmoni + logqstopni + backni + escni + numni + year_dum, new_milk)
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
lm.object <- lm(bid ~ inc + lfci + lfwi + wci + logfmoi + logqstopi + backi + esci + numi
+ lfcni + lfwni + wcni + logfmoni + logqstopni + backni + escni + numni + year_dum, new_milk)
summary(lm.object )
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
rm(list=ls())
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"type" = "lfc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_wc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"type" = "wc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_lfw <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"type" = "lfw",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_ww <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"type" = "ww",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$type_dum <- factor(new_milk$type)
new_milk$type_dum <- relevel(new_milk$type_dum, ref = "ww")
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
library(IDPmisc)
new_milk<-NaRV.omit(new_milk)
lm.object <- lm(bid ~ inc + type_dum*inc + logfmo*inc + logqstop*inc + back*inc + esc*inc +  num*inc + type_dum*(1-inc)
+ logfmo*(1-inc) + logqstop*(1-inc) + back*(1-inc) + esc*(1-inc) +  num*(1-inc)
+ year_dum, data=new_milk)
summary(lm.object)
rm(list=ls())
milk <- data.frame(read.csv("~/Documents/summer_ra/tx_milk/data/milk_out.csv"))
new_lfc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFC),
"inc" = milk$I,
"type" = "lfc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_wc <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WC),
"inc" = milk$I,
"type" = "wc",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_lfw <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$LFW),
"inc" = milk$I,
"type" = "lfw",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_ww <- data.frame("rowid" = milk$rowid,
"vendor" = milk$VENDOR,
"system" = milk$SYSTEM,
"year" = milk$YEAR,
"biddate" =   paste(milk$MONTH, milk$DAY, milk$YEAR, sep="-"),
"bid" = log(milk$WW),
"inc" = milk$I,
"type" = "ww",
"logfmo" =  log(milk$FMO),
"logqstop" =  log(milk$QSTOP),
"back" = log(1+milk$BACKLOG),
"esc" =  milk$ESC,
"num" =  milk$N)
new_milk <- rbind(new_lfc, new_lfw, new_wc, new_ww)
new_milk$type_dum <- factor(new_milk$type)
new_milk$type_dum <- relevel(new_milk$type_dum, ref = "ww")
new_milk$year_dum <- factor(new_milk$year)
new_milk$sys_dum <- factor(new_milk$system)
library(IDPmisc)
new_milk<-NaRV.omit(new_milk)
lm.object <- lm(bid ~ inc + type_dum*inc + logfmo*inc + logqstop*inc + back*inc + esc*inc +  num*inc + type_dum*(1-inc)
+ logfmo*(1-inc) + logqstop*(1-inc) + back*(1-inc) + esc*(1-inc) +  num*(1-inc)
+ year_dum, data=new_milk)
summary(lm.object)
